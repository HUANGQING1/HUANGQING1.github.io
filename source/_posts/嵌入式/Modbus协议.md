---
abbrlink: 1
---

# 参考资料：

```
https://blog.csdn.net/qq_21805743/article/details/120560226(转载自它，留个备份)
https://www.cnblogs.com/NickShen86/p/12809518.html
```

# Modbus-RTU协议

### 一、功能码0x03：读保持寄存器，可读多个或者单个寄存器内容

**主机请求**

| 域名            | 所占字节数 | 可输入的数据内容                                     |
| --------------- | ---------- | ------------------------------------------------------ |
| 从机地址        | 1个字节    | 根据从机地址而定                                       |
| 功能码          | 1个字节    | 0x03                                                 |
| 寄存器起始地址  | 2个字节    | 根据所要读取的寄存器位置而定，范围是0x0000 至 0xFFFF |
| 寄存器数目      | 2个字节    | 1 至 125（0x7D)                                       |
| CRC校验码       | 2个字节    | 根据前面的数据计算出来                                 |

**从机响应**

| 域名       | 所占字节数 | 返回的数据内容                                        |
| ---------- | ---------- | ----------------------------------------------------- |
| 从机地址   | 1个字节    | 从机地址                                              |
| 功能码     | 1个字节    | 0x03                                                  |
| 字节数     | 1个字节    | 2×N                                                   |
| 寄存器的值 | N×2 个字节 | 根据所读取的保持寄存器内容而定 |
| CRC校验码  | 2个字节    | 根据前面的数据计算出来(先发低字节，后发高字节)        |
**其中N ＝ 寄存器的数量**
**从机返回错误帧**

| 域名      | 所占字节数 | 返回的数据内容         |
| --------- | ---------- | ---------------------- |
| 从机地址  | 1个字节    | 从机地址               |
| 功能码    | 1个字节    | 0x83                   |
| 异常码    | 1个字节    | 01 或 02 或 03 或 04   |
| CRC校验码 | 2个字节    | 根据前面的数据计算出来 |





### 二、功能码 0x06：写单个保持寄存器
写单个保持寄存器的返回帧和写入帧是一模一样‘


**主机请求**

| 域名       | 所占字节数 | 可输入的数据内容                                     |
| ---------- | ---------- | ---------------------------------------------------- |
| 从机地址   | 1个字节    | 根据从机地址而定                                     |
| 功能码     | 1个字节    | 0x06                                                 |
| 寄存器地址 | 2个字节    | 根据所要写入的寄存器位置而定，范围是0x0000 至 0xFFFF |
| 寄存器值   | 2个字节    | 0x0000 至 0xFFFF                                     |
| CRC校验码  | 2个字节    | 根据前面的数据计算出来                               |

**从机响应**

| 域名       | 所占字节数 | 返回的数据内容                                   |
| ---------- | ---------- | ------------------------------------------------ |
| 从机地址   | 1个字节    | 根据从机地址而定                                 |
| 功能码     | 1个字节    | 0x06                                             |
| 寄存器地址 | 2个字节    | 根据从机被读取的地址而定，范围是0x0000 至 0xFFFF |
| 寄存器值   | 2个字节    | 根据从机所存放的数据而定，范围是0x0000 至 0xFFFF |
| CRC校验码  | 2个字节    | 根据前面的数据计算出来                           |

**错误**

| 域名      | 所占字节数 | 返回的数据内容         |
| --------- | ---------- | ---------------------- |
| 从机地址  | 1个字节    | 从机地址               |
| 差错码    | 1个字节    | 0x86                   |
| 异常码    | 1个字节    | 01 或 02 或 03 或 04   |
| CRC校验码 | 2个字节    | 根据前面的数据计算出来 |




### 三、功能码 0x10：写多个保持寄存器

**主机请求**

| 域名                    | 所占字节数 | 可输入的数据内容                                     |
| ----------------------- | ---------- | ---------------------------------------------------- |
| 从机地址                | 1个字节    | 根据从机地址而定                                     |
| 功能码                  | 1个字节    | 0x10                                                 |
| 寄存器起始地址          | 2个字节    | 根据所要写入的寄存器位置而定，范围是0x0000 至 0xFFFF |
| 寄存器数目              | 2个字节    | 根据所要写入的寄存器数目而定，范围是0x0001 至 0x0078 |
| 字节数                  | 1个字节    | 2×N                                                  |
| 寄存器值                | N×2 个字节 | 要写入的数据值                                       |
| CRC校验码               | 2个字节    | 根据前面的数据计算出来                               |
**其中，N为寄存器的数量**

**从机响应**

| 域名           | 所占字节数 | 返回的数据内容                                     |
| -------------- | ---------- | -------------------------------------------------- |
| 从机地址       | 1个字节    | 根据从机地址而定                                   |
| 功能码         | 1个字节    | 0x10                                               |
| 寄存器起始地址 | 2个字节    | 根据被写入的寄存器地址而定，范围是0x0000 至 0xFFFF |
| 寄存器数目     | 2个字节    | 1 至 123（0x7B）                                   |
| CRC校验码      | 2个字节    | 根据前面的数据计算出来                             |

**错误**

| 域名      | 所占字节数 | 返回的数据内容         |
| --------- | ---------- | ---------------------- |
| 从机地址  | 1个字节    | 从机地址               |
| 差错码    | 1个字节    | 0x90                   |
| 异常码    | 1个字节    | 01 或 02 或 03 或 04   |
| CRC校验码 | 2个字节    | 根据前面的数据计算出来 |




