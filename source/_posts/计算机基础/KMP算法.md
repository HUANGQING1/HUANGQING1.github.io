---
abbrlink: 11
tags:
  - 草稿
title: KMP算法
---
KMP算法



next[i]取值：假定子串第i个位置字符正与主串匹配失败，那么子串跳转到next[i]位置处重新匹配

nextval[i]:假定子串第i个位置字符正与主串匹配失败，如果子串i1=next[i]处字符与之不同，可能能匹配成功，子串跳转到 i1位置匹配，如果相同，必定匹配失败，递归继续寻找

有两种next数组取值方法，另外一种是对应值是左移减1

| 下标                   |  1   |  2   |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10  |  11  |  12  |      |      |      |      |      |      |      |
| :--------------------- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 串                     |  a   |  a   |  a   |  b   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| next数组值             |  0   |  1   |  2   |  3   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
|                        |  a   |  a   |  a   |  a   |  b   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
|                        |  0   |  1   |  2   |  3   |  4   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
|                        |  a   |  b   |  c   |  a   |  c   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
|                        |  0   |  1   |  1   |  1   |  2   |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
|                        |  a   |  b   |  a   |  b   |  a   |  a   |  a   |  b   |  a   |  b   |  a   |  a   |      |      |      |      |      |      |      |
|                        |  0   |  1   |  1   |  2   |  3   |  4   |  2   |  2   |  3   |  4   |  5   |  6   |      |      |      |      |      |      |      |
| 另外一种<br />next数组 |  -1  |  0   |  0   |  1   |  2   |  3   |  1   |  1   |  2   |  3   |  4   |  5   |      |      |      |      |      |      |      |
| nextval                |  0   |  1   |  0   |  1   |  0   |  4   |  2   |  1   |  0   |  1   |  0   |  4   |      |      |      |      |      |      |      |
|                        |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |

```

```

|                | 0      | 1    | 1    | 1    | ?    |       |                                                              |      |      |      |      |      |      |      |
| :------------: | ------ | ---- | ---- | ---- | ---- | ----- | ------------------------------------------------------------ | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
|    假设主串    | ？     | a    | b    | c    | a    | ***** | ?                                                            |      |      |      |      |      |      |      |
|                | 移动前 | a    | b    | c    | a    | **c** | (c与*不匹配)                                                 |      |      |      |      |      |      |      |
| 计算next数组值 | a      | b    | c    | a    | c    |       |                                                              |      |      |      |      |      |      |      |
|                | 移动后 |      |      |      | a    | **b** | c                                                            | a    | c    |      |      |      |      |      |
|                |        |      |      |      |      |       | 最长公共前后缀a<br />故从第2个元素b开始比较，比较b与*<br />也就是最长公共前后缀长度+1 |      |      |      |      |      |      |      |